<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Vallarta Gardens ¬∑ La Cruz de Huanacaxtle</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Jost:wght@200;300;400;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
  :root {
    --cream: #FAF7F2; --warm: #F0E8D8;
    --ocean: #1C4E6E; --ocean-deep: #0D2E44;
    --turquoise: #4AACCF; --gold: #C8A96E; --gold-light: #E8C98E;
  }
  html, body { width:100%; height:100%; font-family:'Jost',sans-serif; background:var(--ocean-deep); overflow:hidden; }

  /* ‚îÄ‚îÄ WELCOME ‚îÄ‚îÄ */
  #welcome {
    position:fixed; inset:0; z-index:100;
    display:flex; flex-direction:column;
    transition:opacity 0.8s ease, transform 0.8s ease;
  }
  #welcome.hiding { opacity:0; transform:scale(1.04); pointer-events:none; }

  .hero-bg {
    position:absolute; inset:0;
    background:url('https://i.imgur.com/KNqeM92.jpeg') center 30%/cover;
    filter:brightness(0.52);
    animation:slowZoom 18s ease-out forwards;
  }
  @keyframes slowZoom { to { transform:scale(1.06); } }

  .hero-overlay {
    position:absolute; inset:0;
    background: linear-gradient(to top, rgba(13,46,68,0.97) 0%, rgba(13,46,68,0.3) 55%, transparent 100%),
                linear-gradient(to right, rgba(13,46,68,0.45) 0%, transparent 65%);
  }

  .hero-content {
    position:relative; z-index:2;
    display:flex; flex-direction:column; justify-content:flex-end;
    height:100%; padding:clamp(32px,6vw,72px); padding-bottom:clamp(48px,8vw,88px);
  }

  .property-tag {
    display:inline-flex; align-items:center; gap:8px;
    background:rgba(200,169,110,0.15); border:1px solid rgba(200,169,110,0.4);
    border-radius:40px; padding:7px 18px;
    font-size:11px; font-weight:400; letter-spacing:3px; text-transform:uppercase;
    color:var(--gold-light); margin-bottom:24px; width:fit-content;
    opacity:0; animation:fadeUp 0.7s 0.5s forwards;
  }
  .property-tag::before { content:''; width:6px; height:6px; border-radius:50%; background:var(--gold); animation:blink 2s infinite; }
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.3} }

  h1 {
    font-family:'Cormorant Garamond',serif;
    font-size:clamp(52px,10vw,112px); font-weight:300; line-height:0.92;
    color:white; letter-spacing:-1px; margin-bottom:10px;
    opacity:0; animation:fadeUp 0.8s 0.7s forwards;
  }
  h1 em { font-style:italic; color:rgba(255,255,255,0.7); }

  .location-line {
    display:flex; align-items:center; gap:12px; margin-bottom:44px;
    opacity:0; animation:fadeUp 0.7s 0.9s forwards;
  }
  .location-line::before { content:''; width:32px; height:1px; background:var(--gold); flex-shrink:0; }
  .location-line span { font-size:13px; font-weight:200; letter-spacing:4px; text-transform:uppercase; color:rgba(255,255,255,0.5); }

  .cta-group { display:flex; flex-direction:column; gap:14px; max-width:420px; opacity:0; animation:fadeUp 0.7s 1.1s forwards; }

  .btn-primary {
    display:flex; align-items:center; justify-content:space-between;
    background:var(--gold); color:var(--ocean-deep); border:none; border-radius:12px;
    padding:20px 28px; font-family:'Jost',sans-serif; font-size:16px; font-weight:500;
    cursor:pointer; transition:all 0.3s; width:100%;
  }
  .btn-primary:hover { background:var(--gold-light); transform:translateY(-2px); box-shadow:0 12px 40px rgba(200,169,110,0.35); }
  .btn-primary .btn-sub { font-size:12px; font-weight:300; opacity:0.7; margin-top:2px; }
  .btn-primary .arr { font-size:22px; }

  .btn-secondary {
    display:flex; align-items:center; justify-content:space-between;
    background:rgba(255,255,255,0.07); color:white;
    border:1px solid rgba(255,255,255,0.18); border-radius:12px;
    padding:18px 28px; font-family:'Jost',sans-serif; font-size:15px; font-weight:300;
    cursor:pointer; transition:all 0.3s; backdrop-filter:blur(8px); width:100%;
  }
  .btn-secondary:hover { background:rgba(255,255,255,0.13); }
  .btn-secondary .arr { font-size:18px; opacity:0.6; }

  .hero-strip {
    position:absolute; top:clamp(24px,4vw,48px); right:clamp(24px,4vw,48px);
    display:flex; flex-direction:column; align-items:flex-end; gap:6px;
    opacity:0; animation:fadeIn 0.8s 1.3s forwards;
  }
  .strip-badge {
    background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15);
    border-radius:8px; padding:8px 14px; font-size:12px; font-weight:300;
    color:rgba(255,255,255,0.7); letter-spacing:1px; backdrop-filter:blur(8px);
  }

  /* ‚îÄ‚îÄ TOUR SCREEN ‚îÄ‚îÄ */
  #tour-screen {
    position:fixed; inset:0; z-index:50;
    background:url('https://i.imgur.com/fh2quot.jpeg') center/cover; opacity:0; pointer-events:none;
    transition:opacity 0.8s ease;
    display:flex; flex-direction:column;
  }
  #tour-screen.active { opacity:1; pointer-events:all; }

  .tour-bar {
    display:flex; align-items:center; justify-content:space-between;
    padding:14px 24px; background:var(--ocean-deep);
    border-bottom:1px solid rgba(255,255,255,0.08); flex-shrink:0;
  }
  .tour-brand { font-family:'Cormorant Garamond',serif; font-size:22px; font-weight:300; color:white; letter-spacing:1px; }
  .tour-brand em { font-style:italic; color:var(--gold); }

  .tour-actions { display:flex; align-items:center; gap:10px; }
  .tour-btn {
    display:flex; align-items:center; gap:7px;
    background:rgba(255,255,255,0.07); border:1px solid rgba(255,255,255,0.12);
    border-radius:8px; padding:9px 16px; color:white;
    font-family:'Jost',sans-serif; font-size:13px; font-weight:300;
    cursor:pointer; transition:all 0.25s; text-decoration:none;
  }
  .tour-btn:hover { background:rgba(255,255,255,0.13); }
  .tour-btn.gold { background:rgba(200,169,110,0.15); border-color:rgba(200,169,110,0.35); color:var(--gold-light); }
  .tour-btn.gold:hover { background:rgba(200,169,110,0.25); }
  .back-btn {
    background:none; border:none; color:rgba(255,255,255,0.5); font-size:13px;
    font-family:'Jost',sans-serif; cursor:pointer;
    display:flex; align-items:center; gap:6px; padding:9px 12px; border-radius:8px; transition:all 0.2s;
  }
  .back-btn:hover { color:white; background:rgba(255,255,255,0.07); }

  /* ‚îÄ‚îÄ CHAPTER PILLS ‚îÄ‚îÄ */
  .chapter-bar {
    display:flex; align-items:center; gap:8px; padding:12px 24px;
    background:rgba(10,38,56,0.98); border-bottom:1px solid rgba(255,255,255,0.06);
    overflow-x:auto; flex-shrink:0; scrollbar-width:none;
  }
  .chapter-bar::-webkit-scrollbar { display:none; }

  .chapter-pill {
    display:flex; align-items:center; gap:7px; white-space:nowrap;
    padding:8px 18px; border-radius:24px; font-size:12px; font-weight:400; letter-spacing:0.5px;
    color:rgba(255,255,255,0.45); background:rgba(255,255,255,0.05);
    border:1px solid rgba(255,255,255,0.08);
    cursor:pointer; transition:all 0.3s ease; user-select:none;
  }
  .chapter-pill:hover { color:rgba(255,255,255,0.75); background:rgba(255,255,255,0.1); border-color:rgba(255,255,255,0.2); }
  .chapter-pill.active { background:rgba(200,169,110,0.2); border-color:rgba(200,169,110,0.5); color:var(--gold-light); }
  .chapter-dot { width:6px; height:6px; border-radius:50%; background:currentColor; opacity:0.7; }

  /* ‚îÄ‚îÄ MAIN AREA: kuula + chapter overlay ‚îÄ‚îÄ */
  .tour-main { flex:1; position:relative; overflow:hidden; }


  /* Chapter content overlay */
  #chapterOverlay {
    position:absolute; inset:0;
    background:rgba(10,30,46,0.92); backdrop-filter:blur(6px);
    z-index:10; display:none; flex-direction:column;
    overflow-y:auto;
  }
  #chapterOverlay.open { display:flex; animation:fadeIn 0.35s ease; }

  .chapter-card {
    max-width:680px; width:100%; margin:auto; padding:40px 32px;
  }

  .chapter-card-label {
    font-size:11px; letter-spacing:4px; text-transform:uppercase;
    color:var(--gold); margin-bottom:12px; font-weight:400;
  }
  .chapter-card h2 {
    font-family:'Cormorant Garamond',serif; font-size:clamp(32px,5vw,52px);
    font-weight:300; color:white; line-height:1.1; margin-bottom:16px;
  }
  .chapter-card .chapter-desc {
    font-size:15px; color:rgba(255,255,255,0.6); line-height:1.7;
    margin-bottom:32px; font-weight:300;
  }

  /* Scene grid */
  .scene-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); gap:12px; margin-bottom:32px; }

  .scene-card {
    background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.1);
    border-radius:12px; padding:16px; cursor:default;
  }
  .scene-icon { font-size:24px; margin-bottom:8px; }
  .scene-name { font-size:13px; font-weight:400; color:rgba(255,255,255,0.85); margin-bottom:4px; }
  .scene-hint { font-size:11px; color:rgba(255,255,255,0.4); }

  /* Info rows inside chapter */
  .info-row {
    display:flex; gap:14px; align-items:flex-start;
    background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.09);
    border-radius:12px; padding:16px 20px; margin-bottom:10px;
  }
  .info-row-icon { font-size:22px; flex-shrink:0; margin-top:2px; }
  .info-row h4 { font-size:14px; font-weight:500; color:white; margin-bottom:3px; }
  .info-row p { font-size:13px; color:rgba(255,255,255,0.55); line-height:1.6; }

  .copy-inline {
    display:inline-flex; align-items:center; gap:5px; margin-top:8px;
    background:var(--ocean); color:white; border:none; border-radius:6px;
    padding:6px 12px; font-size:11px; font-family:'Jost',sans-serif; cursor:pointer; transition:all 0.2s;
  }
  .copy-inline:hover { background:var(--ocean-deep); }

  .spot-row { display:flex; gap:14px; align-items:flex-start; padding:14px 0; border-bottom:1px solid rgba(255,255,255,0.07); }
  .spot-row:last-child { border-bottom:none; }
  .spot-num-w { width:28px; height:28px; border-radius:50%; background:var(--gold); color:var(--ocean-deep); font-family:'Cormorant Garamond',serif; font-size:16px; font-weight:700; display:flex; align-items:center; justify-content:center; flex-shrink:0; margin-top:2px; }
  .spot-row h5 { font-size:14px; font-weight:500; color:white; margin-bottom:3px; }
  .spot-row p { font-size:13px; color:rgba(255,255,255,0.5); line-height:1.5; }

  .close-chapter-btn {
    display:flex; align-items:center; gap:8px;
    background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15);
    color:white; border-radius:10px; padding:12px 22px;
    font-family:'Jost',sans-serif; font-size:14px; cursor:pointer; transition:all 0.2s;
    margin-top:8px; width:fit-content;
  }
  .close-chapter-btn:hover { background:rgba(255,255,255,0.15); }

  /* ‚îÄ‚îÄ INFO SIDE PANEL ‚îÄ‚îÄ */
  #info-panel {
    position:fixed; top:0; right:0; bottom:0; width:min(380px,100vw);
    background:var(--cream); z-index:200;
    transform:translateX(100%); transition:transform 0.5s cubic-bezier(0.22,1,0.36,1);
    display:flex; flex-direction:column;
    box-shadow:-20px 0 60px rgba(0,0,0,0.3);
  }
  #info-panel.open { transform:translateX(0); }

  .panel-header { background:var(--ocean-deep); padding:24px; display:flex; align-items:center; justify-content:space-between; }
  .panel-title { font-family:'Cormorant Garamond',serif; font-size:22px; font-weight:300; color:white; }
  .panel-close { width:36px; height:36px; border-radius:50%; background:rgba(255,255,255,0.1); border:none; color:white; font-size:18px; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:all 0.2s; }
  .panel-close:hover { background:rgba(255,255,255,0.2); }
  .panel-body { padding:28px; overflow-y:auto; flex:1; }

  .icard { background:white; border-radius:14px; padding:20px; margin-bottom:16px; border-left:3px solid var(--gold); box-shadow:0 2px 12px rgba(0,0,0,0.06); }
  .icard-hd { display:flex; align-items:center; gap:12px; margin-bottom:10px; }
  .icard-icon { width:40px; height:40px; border-radius:10px; background:var(--warm); display:flex; align-items:center; justify-content:center; font-size:20px; flex-shrink:0; }
  .icard h4 { font-size:15px; font-weight:500; color:var(--ocean-deep); }
  .icard p { font-size:14px; color:#555; line-height:1.65; }
  .copy-btn { display:inline-flex; align-items:center; gap:6px; margin-top:10px; background:var(--ocean); color:white; border:none; border-radius:7px; padding:7px 14px; font-size:12px; font-family:'Jost',sans-serif; cursor:pointer; transition:all 0.2s; }
  .copy-btn:hover { background:var(--ocean-deep); }

  /* ‚îÄ‚îÄ UTILS ‚îÄ‚îÄ */
  @keyframes fadeUp { from{opacity:0;transform:translateY(24px)} to{opacity:1;transform:translateY(0)} }
  @keyframes fadeIn { from{opacity:0} to{opacity:1} }

  .sos-pill { background:rgba(220,50,50,0.12) !important; border-color:rgba(220,80,80,0.35) !important; color:#FF8A8A !important; }
  .sos-pill:hover { background:rgba(220,50,50,0.25) !important; border-color:rgba(220,80,80,0.6) !important; }
  .sos-pill.active { background:rgba(220,50,50,0.3) !important; border-color:rgba(220,80,80,0.7) !important; color:#FFB3B3 !important; }

  .problem-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:12px; margin-bottom:28px; }
  .problem-btn { background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.12); border-radius:14px; padding:20px 18px; cursor:pointer; transition:all 0.25s; text-align:left; color:white; font-family:"Jost",sans-serif; width:100%; }
  .problem-btn:hover { background:rgba(255,100,100,0.15); border-color:rgba(255,100,100,0.4); transform:translateY(-2px); }
  .problem-btn .pb-icon { font-size:28px; margin-bottom:10px; }
  .problem-btn .pb-title { font-size:14px; font-weight:500; margin-bottom:4px; }
  .problem-btn .pb-sub { font-size:12px; color:rgba(255,255,255,0.45); line-height:1.4; }
  .wa-direct { display:flex; align-items:center; gap:12px; background:rgba(37,211,102,0.12); border:1px solid rgba(37,211,102,0.35); border-radius:14px; padding:18px 22px; color:white; text-decoration:none; transition:all 0.25s; margin-bottom:10px; }
  .wa-direct:hover { background:rgba(37,211,102,0.22); border-color:rgba(37,211,102,0.6); }
  .wa-direct .wa-icon { font-size:26px; flex-shrink:0; }
  .wa-direct h4 { font-size:14px; font-weight:500; margin-bottom:2px; }
  .wa-direct p { font-size:12px; color:rgba(255,255,255,0.5); }

  @media(max-width:600px) {
    h1{font-size:52px} .hero-strip{display:none}
    .tour-bar{padding:10px 14px} .chapter-bar{padding:10px 14px}
    .chapter-card{padding:28px 20px}
    .scene-grid{grid-template-columns:repeat(auto-fill,minmax(140px,1fr))}
  }
</style>
</head>
<body>

<!-- ‚ïê‚ïê WELCOME ‚ïê‚ïê -->
<div id="welcome">
  <div class="hero-bg"></div>
  <div class="hero-overlay"></div>
  <div class="hero-strip">
    <div class="strip-badge">La Cruz de Huanacaxtle, Nayarit</div>
  </div>
  <div class="hero-content">
    <div class="property-tag">Your home away from home</div>
    <h1>Vallarta Gardens 2302<br><em>Puerto Vallarta</em></h1>
    <div class="location-line"><span>Welcome to your home by the sea</span></div>
    <div class="cta-group">
      <button class="btn-primary" onclick="startGuided()">
        <div><div>Take me through the home</div><div class="btn-sub">Guided tour ¬∑ perfect for everyone</div></div>
        <div class="arr">‚ñ∂</div>
      </button>

    </div>
  </div>
</div>

<!-- ‚ïê‚ïê TOUR SCREEN ‚ïê‚ïê -->
<div id="tour-screen">

  <div class="tour-bar">
    <div style="display:flex;align-items:center;gap:14px;">
      <button class="back-btn" onclick="goBack()">‚Üê Home</button>
      <div class="tour-brand">Vallarta Gardens 2302 <em>PV</em></div>
    </div>
    <div class="tour-actions">
      <button class="tour-btn gold" onclick="openPanel()">üìã House Info</button>
      <a href="https://wa.me/523222440051" target="_blank" class="tour-btn">üí¨ WhatsApp</a>
    </div>
  </div>

  <!-- Chapter pills ‚Äî all clickable -->
  <div class="chapter-bar" id="chapterBar">
    <div class="chapter-pill active" onclick="openChapter(0)"><div class="chapter-dot"></div>üö™ Arrival</div>
    <div class="chapter-pill" onclick="openChapter(1)"><div class="chapter-dot"></div>üõã Living & Dining</div>
    <div class="chapter-pill" onclick="openChapter(2)"><div class="chapter-dot"></div>üç≥ Kitchen</div>
    <div class="chapter-pill" onclick="openChapter(3)"><div class="chapter-dot"></div>üõè Bedrooms</div>
    <div class="chapter-pill" onclick="openChapter(4)"><div class="chapter-dot"></div>üöø Bathrooms</div>
    <div class="chapter-pill" onclick="openChapter(5)"><div class="chapter-dot"></div>üèä Terrace & Pool</div>
    <div class="chapter-pill" onclick="openChapter(6)"><div class="chapter-dot"></div>üåÆ Local Spots</div>
    <div class="chapter-pill" onclick="openChapter(7)"><div class="chapter-dot"></div>‚ÑπÔ∏è House Info</div>
    <div class="chapter-pill" onclick="openChapter(8)"><div class="chapter-dot"></div>üçΩ Kovay Restaurant</div>
    <div class="chapter-pill" onclick="openChapter(9)"><div class="chapter-dot"></div>üå§ Today's Weather</div>
    <div class="chapter-pill sos-pill" onclick="openChapter(10)"><div class="chapter-dot"></div>üÜò I have a problem</div>
  </div>

  <div class="tour-main">
    <!-- Chapter overlay panel -->
    <div id="chapterOverlay">
      <div class="chapter-card" id="chapterContent"></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê INFO SIDE PANEL ‚ïê‚ïê -->
<div id="info-panel">
  <div class="panel-header">
    <div class="panel-title">Your Stay Info</div>
    <button class="panel-close" onclick="closePanel()">‚úï</button>
  </div>
  <div class="panel-body">
    <div class="icard">
      <div class="icard-hd"><div class="icard-icon">üì∂</div><h4>WiFi</h4></div>
      <p><strong>Network:</strong> Totalplay-E1AD<br><strong>Password:</strong> Vallarta2026</p>
      <button class="copy-btn" onclick="copyText('Totalplay-E1AD',this)">üìã Copy password</button>
    </div>
    <div class="icard">
      <div class="icard-hd"><div class="icard-icon">üîë</div><h4>Entry & Check-in</h4></div>
      <p>Key box at the door: code <strong>9854</strong>. Black digital key ‚Äî place it on the lock to enter.</p>
    </div>
    <div class="icard">
      <div class="icard-hd"><div class="icard-icon">‚ùÑÔ∏è</div><h4>Air Conditioning</h4></div>
      <p>Independent control in each room. Press COOL to turn on. Recommended: 22‚Äì24¬∞C.</p>
    </div>
    <div class="icard">
      <div class="icard-hd"><div class="icard-icon">üßπ</div><h4>Additional Cleaning</h4></div>
      <p>Message us on WhatsApp with 24h notice. Free for stays of 7+ nights.</p>
      <a href="https://wa.me/523222440051" target="_blank" class="copy-btn" style="text-decoration:none">üí¨ Request</a>
    </div>
  </div>
</div>
<div id="overlay" onclick="closePanel()" style="position:fixed;inset:0;background:rgba(0,0,0,0.4);z-index:190;opacity:0;pointer-events:none;transition:opacity 0.4s;"></div>

<script>
// ‚îÄ‚îÄ DATA: chapters based on real Kuula scenes ‚îÄ‚îÄ
const chapters = [
  {
    label: 'How to Arrive',
    title: 'Welcome to\nVallarta Gardens 2302',
    desc: 'Your experience starts here. Follow the arrival instructions and you\'ll be inside in minutes.',
    scenes: [],
    map: { lat: 20.753272, lng: -105.371372, label: 'Kovay Gardens ¬∑ La Cruz de Huanacaxtle' },
    info: [
      { icon:'üìã', title:'Gate Registration', body:'Upon arriving at Kovay Gardens, go to the <strong>entrance gate</strong> where staff will complete the check-in registration.<br><br>‚ö†Ô∏è <em>Make sure you have already sent the full guest name list to the host ‚Äî without it, entry may be delayed.</em>' },
      { icon:'üîë', title:'Apartment Access', body:'<strong>1.</strong> Open the key box with code <strong>9854</strong>. Pull the black lever to take out the black digital key.<br><br><strong>2.</strong> Place the key on the electronic door lock to unlock.<br><br><strong>3.</strong> Once inside, insert the digital key in the slot next to the door to activate electricity.<br><br>‚ö†Ô∏è <em>The key is your only access ‚Äî don\'t forget it when you go out.</em>' },
      { icon:'üöó', title:'Parking', body:'No assigned spots ‚Äî park wherever space is available inside the complex.' },
    ]
  },
  {
    label: 'Social Spaces',
    title: 'Living &\nDining Room',
    desc: 'The heart of the apartment. Perfect space to gather, with living area, dining room and access to the terrace.',
    image: 'https://i.imgur.com/e8ObYP6.jpeg',
    scenes: [],
    info: [
      { icon:'üì∫', title:'Television', body:'Smart TV with streaming apps available (Netflix, Prime Video, etc.). Log in with your own accounts. Remotes are on the table.' },
      { icon:'‚ùÑÔ∏è', title:'Air Conditioning', body:'Control on the side wall. Recommended temperature: 22¬∞C.' },
    ]
  },
  {
    label: 'Kitchen',
    title: 'Your full\nkitchen',
    desc: 'Fully equipped with everything you need. Coffee maker, toaster, blender and basic utensils included.',
    image: 'https://i.imgur.com/iHc3Zob.jpeg',
    scenes: [],
    info: [
      { icon:'üç≥', title:'Cookware', body:'Pans, pots and full utensil set in good condition.' },
      { icon:'üçΩ', title:'Tableware', body:'Plates, glasses, mugs, wine glasses, bowls, cutlery and water pitcher.' },
      { icon:'üî™', title:'Knives & more', body:'Knife set, food containers and corkscrew.' },
      { icon:'‚òï', title:'Appliances', body:'Coffee maker, toaster, blender, microwave and oven with mitts.' },
      { icon:'üíß', title:'Water', body:'The entire Kovay Gardens complex has a drinking water filtration system ‚Äî tap water is completely safe to drink.' },
      { icon:'üßÇ', title:'Pantry basics', body:'Coffee, sugar, tea, salt, pepper and oil.' },
      { icon:'üóë', title:'Trash', body:'Staff collects at <strong>10:00 am</strong> and <strong>2:00 pm</strong>.' },
    ]
  },
  {
    label: 'Rest',
    title: 'The\nBedrooms',
    desc: '2 bedrooms with everything you need to rest comfortably.',
    images: ['https://i.imgur.com/HazZpr7.jpeg','https://i.imgur.com/GNBD6A3.jpeg'],
    scenes: [],
    info: [
      { icon:'üõè', title:'Bedroom 1', body:'2 full-size beds.' },
      { icon:'üëë', title:'Bedroom 2', body:'1 king size bed.' },
      { icon:'üëî', title:'Closet', body:'6 hangers per closet.<br><br>üîí <strong>Safe:</strong> available in the main bedroom. If it\'s locked, look for the key <strong>on top of the refrigerator</strong>. If it\'s not there, contact us via WhatsApp.<br><br>‚ö†Ô∏è <em>Please leave it open before checkout.</em>' },
      { icon:'‚ùÑÔ∏è', title:'Air Conditioning', body:'Please remember to turn it off when leaving the apartment.' },
    ]
  },
  {
    label: 'Bathrooms',
    title: 'The\nBathrooms',
    desc: 'Clean towels in each bathroom. If you need more, extras are in the hallway closet.',
    images: ['https://i.imgur.com/AiRZpLs.jpeg','https://i.imgur.com/aEDbrdt.jpeg'],
    scenes: [],
    info: [
      { icon:'üöø', title:'2 full bathrooms', body:'Shower, toilet and sink in each one.' },
      { icon:'üß¥', title:'Amenities', body:'Shampoo, conditioner, body wash and hand soap included.' },
      { icon:'ü™•', title:'Towels', body:'Bath towels and pool towels available.' },
      { icon:'üíá', title:'Extras', body:'Hair dryer, iron and ironing board.' },
      { icon:'üëï', title:'Washing Machine', body:'Normal cycle: 45 min. Detergent is under the kitchen sink along with the other soaps in small bottles.' },
      { icon:'‚ÑπÔ∏è', title:'Amenities note', body:'The amenities we leave (shampoo, soaps, detergent, coffee, etc.) are a welcome courtesy ‚Äî only one initial supply is provided. If they run out during your stay, you can find them at any nearby store.' },
    ]
  },
  {
    label: 'Your paradise',
    title: 'Terrace\n& Pool',
    desc: 'Your outdoor space with a private pool and access to the complex common areas.',
    image: 'https://i.imgur.com/nsaSaYw.jpeg',
    scenes: [],
    info: [
      { icon:'üèä', title:'Private pool', body:'The terrace has a private pool for exclusive use. No schedule ‚Äî available 24 hours.' },
      { icon:'üåä', title:'Complex pools', body:'You also have access to the Selva, Bar and beachfront pools. Towels available at the pool area.' },
      { icon:'‚ö†Ô∏è', title:'Complex common areas', body:'At the complex pools (Selva, Bar, beach) <strong>only items purchased at Kovay restaurant are permitted</strong>. If you bring your own drinks, they must be in a closed thermos or Yeti ‚Äî no visible cups or bottles.' },
    ]
  },
  {
    label: 'Recommendations',
    title: 'Your secret\nspots',
    desc: 'Places you won\'t find on TripAdvisor. I only share these with Vallarta Gardens 2302 guests.',
    spots: [
      { num:'1', name:'El Array√°n', desc:'The best mole in Vallarta. Ask for the back patio table. Cash only.' },
      { num:'2', name:'Playa Gemelas', desc:'15 min by boat from the boardwalk. No tourists, turquoise water. Bring a snorkel.' },
      { num:'3', name:'Sunset at La Cruz', desc:'Arrive at 6pm at the La Cruz pier. Order a mezcal and wait ‚Äî totally worth it.' },
      { num:'4', name:'Mercado Emiliano Zapata', desc:'The cheapest and most delicious breakfast in Vallarta. Birria on Sundays from 8am.' },
    ]
  },
  {
    label: 'Practical Info',
    title: 'Everything you\nneed to know',
    desc: 'Key information for your stay. For any questions, message us on WhatsApp.',
    info: [
      { icon:'üì∂', title:'WiFi ¬∑ Totalplay-E1AD', body:'Password: <strong>E1AD314B3zsvTgw2</strong>', copy:'Vallarta2026' },
      { icon:'üìã', title:'Gate Registration', body:'Upon arriving at Kovay Gardens, go to the <strong>entrance gate</strong> where staff will complete the check-in registration.<br><br>‚ö†Ô∏è <em>Make sure you have already sent the full guest name list to the host ‚Äî without it, entry may be delayed.</em>' },
      { icon:'üîë', title:'Apartment Access', body:'Key box at the door: code <strong>9854</strong>. Take out the black digital key and place it on the lock to open. Insert it inside to activate electricity.' },
      { icon:'üïê', title:'Check-out', body:'At 11:00am. If you need a late checkout let us know 24h in advance.' },
      { icon:'üöë', title:'Emergencies', body:'<strong>911</strong> ‚Äî Police, ambulance and fire.<br>Host 24/7: <a href="tel:+523222440051" style="color:var(--gold-light)">+52 322 244 0051</a>' },
      { icon:'üßπ', title:'Additional cleaning', body:'Available with 24h notice via WhatsApp. Free for stays of 7+ nights.' },
    ]
  }
  ,
  {
    label: 'Inside the complex',
    title: 'Kovay\nRestaurant',
    desc: 'Eat and drink without leaving the complex. Full menu and hours below.',
    kovay: true
  }
  ,
  {
    label: 'La Cruz de Huanacaxtle',
    title: 'Today\'s\nWeather',
    desc: 'Real-time temperature, wind and rain so you can plan your day perfectly.',
    weather: true
  }
  ,
  {
    label: 'We\'re here to help',
    title: 'I have a\nproblem',
    desc: 'Select what\'s happening and we\'ll send a direct WhatsApp message ‚Äî we respond in minutes.',
    sos: true
  }
];

let currentChapterIdx = 0;

function setActivePill(idx) {
  document.querySelectorAll('.chapter-pill').forEach((p,i) => p.classList.toggle('active', i===idx));
  const pill = document.querySelectorAll('.chapter-pill')[idx];
  if (pill) pill.scrollIntoView({ behavior:'smooth', inline:'center', block:'nearest' });
}


function menuSection(title, hours, sections) {
  let h = `<div style="margin-bottom:24px;">
    <div style="display:flex;align-items:baseline;justify-content:space-between;flex-wrap:wrap;gap:8px;margin-bottom:12px;padding-bottom:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
      <div style="font-family:'Cormorant Garamond',serif;font-size:22px;color:white;font-weight:400;">${title}</div>
      <div style="font-size:11px;letter-spacing:2px;text-transform:uppercase;color:var(--gold);">${hours}</div>
    </div>`;
  sections.forEach(s => {
    h += `<div style="margin-bottom:14px;">
      <div style="font-size:10px;letter-spacing:3px;text-transform:uppercase;color:rgba(255,255,255,0.4);margin-bottom:8px;">${s.cat}</div>
      <div style="display:flex;flex-direction:column;gap:4px;">`;
    s.items.forEach(([name, price]) => {
      h += `<div style="display:flex;justify-content:space-between;align-items:baseline;gap:12px;font-size:13px;">
        <span style="color:rgba(255,255,255,0.75);line-height:1.5;">${name}</span>
        <span style="color:var(--gold-light);font-weight:500;white-space:nowrap;flex-shrink:0;">${price}</span>
      </div>`;
    });
    h += `</div></div>`;
  });
  h += `</div>`;
  return h;
}

function openChapter(idx) {
  currentChapterIdx = idx;
  setActivePill(idx);
  const ch = chapters[idx];
  const overlay = document.getElementById('chapterOverlay');
  const content = document.getElementById('chapterContent');

  let html = `
    <div class="chapter-card-label">${ch.label}</div>
    <h2>${ch.title.replace('\n','<br>')}</h2>
    <p class="chapter-desc">${ch.desc}</p>
  `;

  // Space image(s)
  if (ch.image) {
    html += `<div style="width:100%;height:220px;border-radius:16px;overflow:hidden;margin-bottom:24px;border:1px solid rgba(255,255,255,0.08);box-shadow:0 8px 32px rgba(0,0,0,0.3);">
      <img src="${ch.image}" alt="${ch.label}" style="width:100%;height:100%;object-fit:cover;object-position:center;display:block;transition:transform 0.4s ease;" onmouseover="this.style.transform='scale(1.04)'" onmouseout="this.style.transform='scale(1)'"/>
    </div>`;
  }
  if (ch.images && ch.images.length) {
    html += `<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:24px;">`;
    ch.images.forEach((src, i) => {
      html += `<div style="height:200px;border-radius:14px;overflow:hidden;border:1px solid rgba(255,255,255,0.08);box-shadow:0 6px 24px rgba(0,0,0,0.3);">
        <img src="${src}" alt="${ch.label} ${i+1}" style="width:100%;height:100%;object-fit:cover;object-position:center;display:block;transition:transform 0.4s ease;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'"/>
      </div>`;
    });
    html += `</div>`;
  }

  // Scenes grid
  if (ch.scenes && ch.scenes.length) {
    html += `<div class="scene-grid">`;
    ch.scenes.forEach(s => {
      html += `<div class="scene-card"><div class="scene-icon">${s.icon}</div><div class="scene-name">${s.name}</div><div class="scene-hint">${s.hint}</div></div>`;
    });
    html += `</div>`;
  }

  // Map embed
  if (ch.map) {
    html += `<div style="border-radius:16px;overflow:hidden;margin-bottom:24px;border:1px solid rgba(255,255,255,0.1);">
      <div style="background:rgba(255,255,255,0.06);padding:12px 18px;display:flex;align-items:center;justify-content:space-between;">
        <div style="font-size:13px;color:rgba(255,255,255,0.7);display:flex;align-items:center;gap:8px;">
          <span>üìç</span> Exact property location
        </div>
        <a href="https://maps.google.com/?q=${ch.map.lat},${ch.map.lng}" target="_blank"
          style="font-size:12px;color:var(--gold-light);text-decoration:none;letter-spacing:0.5px;">
          Open in Maps ‚Üó
        </a>
      </div>
      <iframe
        src="https://maps.google.com/maps?q=${ch.map.lat},${ch.map.lng}&z=17&output=embed"
        width="100%" height="280" style="border:none;display:block;"
        loading="lazy" allowfullscreen>
      </iframe>
    </div>`;
  }

  // Info rows
  if (ch.info && ch.info.length) {
    ch.info.forEach(r => {
      html += `<div class="info-row">
        <div class="info-row-icon">${r.icon}</div>
        <div><h4>${r.title}</h4><p>${r.body}</p>
        ${r.copy ? `<button class="copy-inline" onclick="copyText('${r.copy}',this)">üìã Copiar</button>` : ''}
        </div>
      </div>`;
    });
  }

  // Spots
  if (ch.spots && ch.spots.length) {
    ch.spots.forEach(s => {
      html += `<div class="spot-row">
        <div class="spot-num-w">${s.num}</div>
        <div><h5>${s.name}</h5><p>${s.desc}</p></div>
      </div>`;
    });
  }

  // Kovay restaurant chapter
  if (ch.kovay) {
    html += `

    <div style="margin-bottom:20px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:14px;padding:16px 20px;">
      <div style="font-size:11px;letter-spacing:3px;text-transform:uppercase;color:var(--gold);margin-bottom:4px;">Every day</div>
      <div style="font-size:13px;color:rgba(255,255,255,0.6);line-height:1.8;">
        ‚òÄÔ∏è <strong style="color:white;">Pasatiempo ¬∑ Deli Caf√©</strong> ‚Äî 7:00 am to 3:00 pm<br>
        üç≥ <strong style="color:white;">La Palma ¬∑ Breakfast</strong> ‚Äî 8:00 am to 12:00 pm<br>
        üåÆ <strong style="color:white;">La Palma ¬∑ Lunch</strong> ‚Äî 12:00 pm to 5:00 pm<br>
        üç∑ <strong style="color:white;">La Palma ¬∑ Dinner</strong> ‚Äî 5:00 pm to 9:00 pm<br>
        üèñ <strong style="color:white;">Snack Bar</strong> ‚Äî Pool area
      </div>
    </div>

    ${menuSection('‚òÄÔ∏è Pasatiempo ¬∑ Deli Caf√©', '7:00 am ‚Äì 3:00 pm', [
      { cat:'Salads', items:[['Cobb','$195'],['C√©sar','$160'],['C√©sar con Pollo','$180'],['Griega','$210']] },
      { cat:'Paninis', items:[['Philly Steak Panini ‚Äî arrachera, pimientos, mayonesa con c√∫rcuma','$235'],['Panini Vegetariano ‚Äî queso de cabra, hongo, espinaca, romero','$210']] },
      { cat:'Sandwiches', items:[['Florentino ‚Äî jam√≥n, espinaca, tocino, huevo, queso blanco','$180'],['Patty Melt ‚Äî carne molida, queso, cebolla caramelizada','$180'],['Montecristo ‚Äî pavo, huevo, az√∫car glass','$150'],['Bagel de Salm√≥n ‚Äî salm√≥n, alcaparras, queso crema','$210'],['Croissant de Huevo','$150']] },
      { cat:'Coffee', items:[['Americano','$55'],['Cappuccino','$75'],['Latte','$75'],['Espresso','$75'],['Bebidas Frappe','$105']] },
      { cat:'Juices', items:[['Vampiro ‚Äî betabel, pi√±a, jengibre, naranja, lim√≥n, miel','$75'],['Menta ‚Äî menta, pepino, pi√±a, apio, manzana, miel','$75'],['Verde Gardens ‚Äî kale, jengibre, espinaca, manzana, pepino, perejil, toronja','$75'],['Apio-Zanahoria','$75']] },
      { cat:'Smoothies', items:[['Blueberries','$105'],['Mango','$85'],['Kiwi','$105'],['Tropical','$85']] },
    ])}

    ${menuSection('üç≥ La Palma ¬∑ Breakfast', '8:00 am ‚Äì 12:00 pm', [
      { cat:'Classics', items:[['Desayuno Buffet','$390'],['Avena con leche/soya/almendra','$198'],['Plato Fruta de Temporada con granola','$205'],['Pan Franc√©s con az√∫car y canela','$270'],['Hot Cake Naturales / Pl√°tano / Manzana','$275'],['Huevos al Gusto 2pzas ‚Äî revueltos, fritos o divorciados','$300']] },
      { cat:'Specialties', items:[['Huevos Motule√±os ‚Äî pl√°tano macho, chicharos, jam√≥n','$312'],['Huevos con Arrachera ‚Äî frijoles, aguacate, queso panela','$360'],['Huevos Divorciados en Salsa Verde y Roja','$312'],['Huevos Benedictos Gratinados ‚Äî salsa holandesa, papa hash brown','$324'],['Huevos Efigenia ‚Äî ahogados en salsa verde o roja, aguacate','$200'],['Omelette al Gusto','$324'],['Omelette Gardens ‚Äî pimiento, espinaca, champi√±√≥n, cebolla morada, reques√≥n','$252'],['Machaca con Huevo y Rajas Poblanas','$312']] },
      { cat:'Chilaquiles & Burritos', items:[['Chilaquiles ‚Äî roja, verde, morita o mole','$275'],['Chilaquiles con Pollo 180gr','$300'],['Burrito Vegetariano ‚Äî mezcla de vegetales, queso, germinado','$312'],['Burrito Gardens ‚Äî jam√≥n, queso, huevo, tocino','$324']] },
      { cat:'Extras', items:[['Camar√≥n 100gr','$111'],['Arrachera 50gr','$111'],['Pollo 100gr','$111'],['Aguacate 50gr','$60'],['Tocino o Salchichas 100gr','$111']] },
    ])}

    ${menuSection('üåÆ La Palma ¬∑ Lunch', '12:00 pm ‚Äì 5:00 pm', [
      { cat:'Starters', items:[['Ceviche Tatemado de Pesca del D√≠a','$300'],['Camarones a la Gabardina ‚Äî empanizado, tempura de cerveza','$540'],['Taco de Marl√≠n ‚Äî jitomate, queso gratinado, tortilla','$220'],['Sopa de Tortilla 370ml','$216'],['Quesadilla con Arrachera y Tortilla de Ma√≠z','$360'],['Tostada de Camar√≥n fresco cocido','$220'],['Taco Placero ‚Äî pesca del d√≠a al ajillo, papa rostizada','$240'],['Nachos ‚Äî frijoles, prote√≠na, queso, jalape√±os, guacamole','$276']] },
      { cat:'Main Course', items:[['Camarones al Gusto 200gr','$492'],['Camarones Zarandeados 200gr','$492'],['Pesca del D√≠a a la Diabla 220gr','$745'],['Pesca del D√≠a al Gusto 220gr','$745'],['Rib Eye en Fajas 500gr','$984'],['Alambre de Res 250gr','$546'],['Arrachera 250gr ‚Äî frijoles, guacamole, chiles toreados','$648'],['Enchiladas de Mariscos ‚Äî camar√≥n, pulpo, pesca, callo','$598'],['Taquitos de Pollo Estilo Vallarta 180gr','$264'],['Club Sandwich 70gr','$264'],['La Cruz Burger 250gr','$456']] },
      { cat:'Desserts', items:[['Brownie de Chocolate','$210'],['Panacota de Menta','$210'],['Cr√®me Br√ªl√©e','$210'],['Pay de Manzana','$210'],['Helados ‚Äî Vainilla, Chocolate, Fresa, Pistache','$210']] },
    ])}

    ${menuSection('üç∑ La Palma ¬∑ Dinner', '5:00 pm ‚Äì 9:00 pm', [
      { cat:'Starters', items:[['Carpacio de Salm√≥n 200gr ‚Äî alcaparras, ar√∫gula, mostaza Dijon','$378'],['Ensalada Gardens 100gr ‚Äî lechugas, hierbabuena, albahaca, frutos rojos','$192'],['Ensalada de Pera 100gr ‚Äî jitomate, queso azul, nuez, miel','$192'],['Aguacate Relleno de Camar√≥n 180gr','$378'],['T√°rtar de At√∫n 180gr ‚Äî aguacate, aceite de oliva, mostaza','$420']] },
      { cat:'Main Course', items:[['Pesca en La Cruz 220gr ‚Äî hierbas mexicanas, lim√≥n, hoja de tamal','$745'],['Pesca del D√≠a Zarandeado 220gr ‚Äî adobo de chiles y lim√≥n','$745'],['Medallones de Res al Vino Tinto 220gr ‚Äî pure de papa r√∫stico, esp√°rrago','$546'],['Rib Eye 500gr ‚Äî Angus, papa horno, vegetales, cebolla flameada','$984'],['Pollo Relleno 4 Quesos 200gr ‚Äî pechuga, espinaca, champi√±√≥n, mozzarella','$420'],['La Cruz Burger 250gr','$456'],['Arroz con Mariscos ‚Äî camar√≥n, pulpo, pesca, callo','$420'],['Camarones al Vino Blanco 200gr','$492'],['Camarones al Gusto 200gr','$492'],['Surf & Turf con Camar√≥n ‚Äî camar√≥n jumbo + filete de res','$1,080'],['Surf & Turf con Langosta ‚Äî langosta 320gr + filete de res','$1,680']] },
      { cat:'Desserts', items:[['Brownie de Chocolate','$210'],['Panacota de Menta','$210'],['Cr√®me Br√ªl√©e','$210'],['Pay de Manzana','$210'],['Helados','$210']] },
    ])}

    ${menuSection('üèñ Snack Bar', 'Pool Area', [
      { cat:'Snacks', items:[['Guacamole con At√∫n Fresco 120gr','$420'],['Guacamole con Chicharr√≥n de Pescado 200gr','$420'],['Guacamole con Chicharr√≥n de Pulpo 200gr','$420'],['Papas a la Francesa 250gr','$111'],['Garden Sliders con Queso ‚Äî 3 pzas','$294']] },
      { cat:'Ceviche & Tacos', items:[['Ceviche de Camar√≥n Chilpet√≠n 140gr','$312'],['Ceviche de Pescado Vallarta 140gr','$312'],['Taco Baja de Pescado ‚Äî 2 pzas','$252'],['Tacos de Camar√≥n Capeado ‚Äî 2 pzas','$300']] },
      { cat:'Quesadillas & Sandwiches', items:[['Quesadillas de Pollo ‚Äî 2 pzas tortilla de harina','$264'],['Quesadillas de Arrachera ‚Äî 2 pzas','$360'],['Sandwich de Pollo en Brioche','$180'],['Club Sandwich ‚Äî pollo, jam√≥n, queso','$264']] },
      { cat:'Wings & Kids Menu', items:[['Alitas de Pollo 250gr ‚Äî BBQ, B√∫falo o Teriyaki, 8 pzas','$168'],['Deditos de Pescado con salsa de jitomat√©','$156'],['Quesadillas Naturales ‚Äî 2 pzas','$192'],['Tenders de Pollo Empanizado','$136'],['Sandwich de Queso Gratinado','$156']] },
      { cat:'Desserts', items:[['Brownie Relleno con Nieve','$210']] },
    ])}
  `;
  }

  // Weather chapter
  if (ch.weather) {
    html += `
    <div style="border-radius:16px;overflow:hidden;margin-bottom:20px;border:1px solid rgba(255,255,255,0.1);">
      <iframe
        src="https://embed.windy.com/embed2.html?lat=20.753&lon=-105.371&detailLat=20.753&detailLon=-105.371&width=650&height=450&zoom=11&level=surface&overlay=temp&product=ecmwf&menu=&message=true&marker=true&calendar=now&pressure=&type=map&location=coordinates&detail=true&metricWind=km%2Fh&metricTemp=%C2%B0C&radarRange=-1"
        width="100%" height="420"
        style="border:none;display:block;"
        frameborder="0">
      </iframe>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:10px;margin-bottom:8px;">
      <div style="background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:16px;text-align:center;">
        <div style="font-size:28px;margin-bottom:6px;">üå°</div>
        <div style="font-size:12px;color:rgba(255,255,255,0.5);margin-bottom:2px;">Typical temperature</div>
        <div style="font-size:18px;font-weight:500;color:white;">24‚Äì30¬∞C</div>
      </div>
      <div style="background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:16px;text-align:center;">
        <div style="font-size:28px;margin-bottom:6px;">üåä</div>
        <div style="font-size:12px;color:rgba(255,255,255,0.5);margin-bottom:2px;">Sea temperature</div>
        <div style="font-size:18px;font-weight:500;color:white;">~27¬∞C</div>
      </div>
      <div style="background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:16px;text-align:center;">
        <div style="font-size:28px;margin-bottom:6px;">üåÖ</div>
        <div style="font-size:12px;color:rgba(255,255,255,0.5);margin-bottom:2px;">Best sunset</div>
        <div style="font-size:18px;font-weight:500;color:white;">6:15‚Äì6:45pm</div>
      </div>
    </div>`;
  }

  // SOS chapter
  if (ch.sos) {
    const WA = '523222440051';
    const problems = [
      { icon:'üíß', title:'No hot water', sub:'Boiler or shower issue', msg:'Hi, I\'m staying at Vallarta Gardens 2302 PV and there\'s no hot water. Can you help?' },
      { icon:'‚ùÑÔ∏è', title:'A/C not working', sub:'Not cooling or not turning on', msg:'Hi, I\'m staying at Vallarta Gardens 2302 PV and the air conditioning is not working. Can you help?' },
      { icon:'üì∂', title:'No WiFi', sub:'No connection or very slow signal', msg:'Hi, I\'m staying at Vallarta Gardens 2302 PV and there\'s no WiFi connection. Can you help?' },
      { icon:'üîë', title:'Can\'t get in', sub:'Issue with key or code', msg:'Hi, I\'m staying at Vallarta Gardens 2302 PV and I have a problem getting into the property. Can you help?' },
      { icon:'üöø', title:'Bathroom issue', sub:'Leak, clog or toilet', msg:'Hi, I\'m staying at Vallarta Gardens 2302 PV and there\'s a bathroom issue (leak, clog or toilet). Can you help?' },
      { icon:'üí°', title:'No electricity', sub:'Power outage or blown bulb', msg:'Hi, I\'m staying at Vallarta Gardens 2302 PV and there\'s an electrical issue, no power in the property. Can you help?' },
      { icon:'ü™≥', title:'Cleaning issue', sub:'Something that needs attention', msg:'Hi, I\'m staying at Vallarta Gardens 2302 PV and there\'s a cleaning issue that needs attention. Can you help?' },
      { icon:'üí¨', title:'Other issue', sub:'Message us directly', msg:'Hi, I\'m staying at Vallarta Gardens 2302 PV and I need help with the following: ' },
    ];
    html += `<div class="problem-grid">`;
    problems.forEach(p => {
      const encoded = encodeURIComponent(p.msg);
      html += `<a href="https://wa.me/${WA}?text=${encoded}" target="_blank" class="problem-btn">
        <div class="pb-icon">${p.icon}</div>
        <div class="pb-title">${p.title}</div>
        <div class="pb-sub">${p.sub}</div>
      </a>`;
    });
    html += `</div>`;
    html += `<a href="https://wa.me/${WA}" target="_blank" class="wa-direct">
      <div class="wa-icon">üí¨</div>
      <div><h4>Talk directly with us</h4><p>WhatsApp ¬∑ We respond in minutes</p></div>
    </a>`;
  }

  // no close button

  content.innerHTML = html;
  overlay.classList.add('open');
  overlay.scrollTop = 0;
}

function closeChapter() {
  document.getElementById('chapterOverlay').classList.remove('open');
}

// Guided mode: NO auto-close ‚Äî user controls everything
let guidedTimer = null;

function startGuidedCycle() {}

function loadKuula() {
  const wrap = document.getElementById('kuulaWrap');
  wrap.innerHTML = '';
  const iframe = document.createElement('iframe');
  iframe.src = 'https://kuula.co/share/collection/7cNb2?logo=1&info=1&fs=1&vr=0&sd=1&thumbs=-1&inst=0';
  iframe.style.width = '100%';
  iframe.style.height = '100%';
  iframe.style.border = 'none';
  iframe.allow = 'xr-spatial-tracking; gyroscope; accelerometer; fullscreen';
  iframe.allowFullscreen = true;
  wrap.appendChild(iframe);
}

function showTour() {
  document.getElementById('welcome').classList.add('hiding');
  setTimeout(() => {
    document.getElementById('welcome').style.display = 'none';
    document.getElementById('tour-screen').classList.add('active');
    loadKuula();
  }, 800);
}

function startGuided() {
  showTour();
  setTimeout(() => openChapter(0), 400);
}

function startFree() {
  showTour();
}

function goBack() {
  clearTimeout(guidedTimer);
  document.getElementById('tour-screen').classList.remove('active');
  const w = document.getElementById('welcome');
  w.style.display = '';
  setTimeout(() => w.classList.remove('hiding'), 50);
  closeChapter();
  setActivePill(0);
}

function openPanel() {
  document.getElementById('info-panel').classList.add('open');
  const ov = document.getElementById('overlay');
  ov.style.opacity='1'; ov.style.pointerEvents='all';
}
function closePanel() {
  document.getElementById('info-panel').classList.remove('open');
  const ov = document.getElementById('overlay');
  ov.style.opacity='0'; ov.style.pointerEvents='none';
}

function copyText(text, btn) {
  navigator.clipboard.writeText(text).then(() => {
    const orig = btn.textContent;
    btn.textContent = '‚úì Copied';
    setTimeout(() => btn.textContent = orig, 2000);
  });
}
</script>
</body>
</html>
